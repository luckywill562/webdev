import{R as e,b as k,L as T}from"./vendor.7b712f9f.js";import{w as B,az as z,F as K}from"./GeneralCondition.59d0a2ff.js";import{a0 as R,s as v,c as O}from"./main.da775b16.js";import{M as U,a as G,o as V}from"./preview.f9c940e2.js";const X=()=>{const[o,Z]=e.useState(new R),[s,m]=e.useState([]),[l,y]=e.useState(0),[E,x]=e.useState({}),[n,r]=e.useState([]),[c,A]=e.useState(""),[u,F]=e.useState(1),[C,g]=e.useState(!1),p=e.createRef(null),P=e.createRef(null),[b,f]=e.useState(!1),d=k(),i=60,[I,j]=e.useState(void 0),w=a=>{p.current.click()},S=a=>{let t=a.target.value;A(t)},L=a=>{F(a),g(!1)},q=a=>{V(x,a,n,s,r,m),p.current.value=""},M=a=>{const t=n.slice(),h=s.slice();h.splice(a,1),m(h),t.splice(a,1),r(t)};o.on_error=(a,t)=>{d(v({message:"une erreur s'est produite lors de l'upload de votre contenu"}))},o.on_abort=function(a){console.log("action avorter")},o.on_upload_progress=a=>{const t=n.slice();t[l].uploadPercent=a.percentage,r(t)},o.on_done=a=>{y(l+1)},e.useEffect(()=>{setTimeout(()=>{N(I)},1)},[l]);const N=a=>{s.length>0&&s[l]?o.upload_chunked("/api",s[l],null,{media_appartenance:"album",params:JSON.stringify(n[l]),albumId:a}):s.length>0&&!s[l]&&(d(v({message:"votre contenu est pr\xE8te"})),f(!1),m([]),r([]),setTimeout(()=>{d(O())},2e3))},_=async()=>{if(f(!0),s.length>0&&c.length<=i&&u>0&&!b){var a=new FormData;a.append("url","./RESTAPI/Album/new"),a.append("params",JSON.stringify(n)),a.append("album_title",c),a.append("security",u),K("/create-album",a,t=>{t.success===1&&(j(t.albumId),d(v({message:"votre album a \xE9t\xE9 cr\xE9er, upload des medias en cours..."})),N(t.albumId))})}else alert("ajouter une image ou une video")};return e.createElement("div",{className:"Fdo Bcg Nfb ELG Flk main-app-width Pap"},e.createElement("div",{className:"Fdo messagerie-container sLayout"},e.createElement("div",{className:"container-box messages-wrapper"},e.createElement("div",{className:"Fdo messages-listing"},e.createElement("div",{className:"messages-list-wrapper"},e.createElement("div",{className:"messages-list-header"},e.createElement("div",{className:"messages-list-title"},"Cr\xE9er un album")),e.createElement("div",{className:"conversation-list-content"},e.createElement("div",{className:"side-bar-message-wrapper message-scrollabled-list messagerie"},e.createElement("div",{className:"Fdo aovydwv3 pybr56ya Kmm"},e.createElement("button",{onClick:w,className:"sqdOP Xdg L3NKy ZIAjV Bsj Bgu "},"Ajouter des photos ou une video")),e.createElement("input",{className:"mkhogb32",accept:"image/jpeg,image/jpg,image/png,video/mp4",type:"file",multiple:!0,onChange:q,style:{display:"none"},ref:p}),e.createElement("div",{className:""},e.createElement("input",{name:"AlbumTitle",maxLength:i,value:c,onChange:S,className:"Text-form",placeholder:"Nom de l'album"})),e.createElement("div",{className:"Fdo",style:{justifyContent:"flex-end"}},e.createElement("span",null,c.length),e.createElement("span",null,"/"),e.createElement("span",null,i)),c.length>i&&e.createElement("p",{style:{color:"red"}},"Le titre ne doit pas contenir plus de ",i," caract\xE8res"),e.createElement(U,{ModalConfident:C,Confidentiality:u,handleChangeConfidentiality:L,setModalConfident:g}))),e.createElement("div",{className:"conversation-footer"},e.createElement("div",{className:"Fdo aovydwv3 pybr56ya Kmm Pap"},b?e.createElement("div",{className:"sqdOP Xdg L3NKy ZIAjV Bsj disabled _Dvgb"},"Publier"):e.createElement("button",{ref:P,className:"sqdOP Xdg L3NKy ZIAjV Bsj _Dvgb",onClick:_},"Publier"))))),e.createElement("div",{className:"messages-text-container"},e.createElement("div",{className:"conversation-container"},e.createElement("div",{className:" Fdo Pac Cdf ELG vgh"},e.createElement("div",{className:"Fdo jifvfom9 lhclo0ds pybr56ya vcx Kmm tw6a2znq d76ob5m9 k4urcfbm rq0escxv"},e.createElement("div",{className:"Fdo Anv "},E.message&&e.createElement("div",{className:"G6S"},E.message),s.length>0?e.createElement("div",{className:"Fdo lhclo0ds"},e.createElement(G,{Medias:s,mediaParams:n,DeleteImage:M,setMediaParams:r,setMedias:m,size:150})):e.createElement("div",{className:"Fdo Anv Pac"},e.createElement("div",{className:"alert-info info"},e.createElement("div",{className:"Fdo"},e.createElement("div",{className:"icon-info"},e.createElement(z,{size:18})),e.createElement("div",{className:"content"},e.createElement("h2",null,"information importantes"),e.createElement("p",{className:"title"},"Certains contenu ne sont pas autoris\xE9 sur tafaray."),e.createElement("p",null,"Par exemple les photos nue ou certains photos en maillot de bain..."),e.createElement("p",null,"Avant de publier quelque chose,nous vous invitons a lire le r\xE8glement si vous les avez pas encore lus car toute personnes qui enfrain cette r\xE8gle risque l'explusion sur tafaray ainsi que les autres plateformes qui appartient a zarao-lab. "),e.createElement(T,{to:"/reglement",className:"btn"},"Lire le r\xE8glement de la comunaut\xE9")))))))))))))};var W=B(X);export{W as default};
