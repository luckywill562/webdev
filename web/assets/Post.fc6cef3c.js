import{i as O,R as e,h as T,b as V,P as Z}from"./vendor.7b712f9f.js";import{l as K,U as X,t as v,F as D}from"./GeneralCondition.59d0a2ff.js";import{a0 as F,s as i,c as G}from"./main.da775b16.js";import{a as H,M as J,o as $}from"./preview.f9c940e2.js";const x=O({useNativeArt:!0}),{EmojiSuggestions:W,EmojiSelect:Q}=x,Y=[x],le=P=>{const[c,ee]=e.useState(new F),[g,S]=e.useState(T.EditorState.createEmpty());var d=K(g);const[a,m]=e.useState([]),[n,C]=e.useState(0),[f,k]=e.useState({}),[l,r]=e.useState([]),[u,w]=e.useState(1),[z,N]=e.useState(!1),E=e.createRef(null),[_,A]=e.useState(void 0),y=e.createRef(null),[p,h]=e.useState(!1),o=V(),I=t=>{E.current.click()},M=()=>{y.current.focus()},q=t=>{S(t)},B=t=>{$(k,t,l,a,r,m),E.current.value=""},L=t=>{const s=l.slice(),j=a.slice();j.splice(t,1),m(j),s.splice(t,1),r(s)},R=t=>{w(t),N(!1)};c.on_error=(t,s)=>{o(i({message:"une erreur s'est produite lors de l'upload"}))},c.on_abort=function(t){console.log("action avorter")},c.on_upload_progress=t=>{const s=l.slice();s[n].uploadPercent=t.percentage,r(s)},c.on_done=t=>{C(n+1)},e.useEffect(()=>{setTimeout(()=>{b(_)},1)},[n]);const b=t=>{a.length>0&&a[n]?c.upload_chunked("/api",a[n],null,{media_appartenance:"post",params:JSON.stringify(l[n]),albumId:t}):a.length>0&&!a[n]&&(o(i({message:"votre contenu est pr\xE8te"})),h(!1),m([]),r([]),new F)},U=async()=>{if(h(!0),a.length>0&&u>0&&!p||v(d).length>0&&u>0&&!p){var t=new FormData;t.append("url","./RESTAPI/Status/new"),t.append("params",JSON.stringify(l)),t.append("post_content",v(d)),t.append("security",u),D("/api",t,s=>{s.success===1?(A(s.postId),a.length>0?(o(i({message:"votre publication a \xE9t\xE9 cr\xE9er, upload des medias en cours..."})),b(s.postId)):o(i({message:"votre publication a \xE9t\xE9 cr\xE9er"})),setTimeout(()=>{o(G())},1e3)):o(i({res:s})),h(!1)})}else alert("ajouter une image ou une video")};return e.createElement("div",{className:"Fdo Anv Ert tw6a2znq vcx Kmm"},e.createElement("div",{className:"Fdo"},e.createElement("div",{className:"page  _4EzTm yC0tu"},e.createElement("div",{className:"_2dbep nmjy",style:{height:56,width:56}},e.createElement("img",{className:"hty ELG hrt lazyload","data-src":P.c_user.avatar.x56}))),e.createElement("div",{className:"Fdo Anv Bsj"},e.createElement("div",{className:"Fdo buofh1pr RpE"},e.createElement("div",{className:"RpE buofh1pr ni8dbmo4 stjgntxs czkt41v7 fmqxjp7s"},e.createElement("div",{className:"buofh1pr Fdo flx89l3n dpja2al7 dfr"},e.createElement("div",{className:"RpE orhb3f3m czkt41v7 fmqxjp7s emzo65vh rq0escxv buofh1pr hpfvmrgz",style:{minHeight:90}},e.createElement("div",{className:"Fdo lhclo0ds bkfpd7mw"},e.createElement("div",{className:`Fdo buofh1pr nhadk0th  hpfvmrgz RpE ${d.length<60?" up":""}`},e.createElement(Z,{editorState:g,onChange:q,plugins:Y,ref:y,onFocus:M,placeholder:e.createElement("div",{style:{fontSize:27}},"Comment allez vous aujourd'hui?"),className:"post container editor"})))))),e.createElement("div",{className:"pmk7jnqg i09qtzwb Fdo Lns Aic cgat1ltu tvmbv18p",style:{right:-10}},e.createElement(Q,null)),e.createElement(W,null)))),e.createElement("div",{className:"Fdo Cdf kzZ"},a.length?e.createElement("div",{className:"Fdo Aic kzZ jifvfom9 pybr56ya d76ob5m9 k4urcfbm rq0escxv"},e.createElement(H,{Medias:a,mediaParams:l,DeleteImage:L,setMediaParams:r,setMedias:m,size:100})):null,f&&e.createElement("div",{className:"G6S"},f.message)),e.createElement("div",{className:"Fdo"},e.createElement("div",{className:"Fdo Bsj Aic"},e.createElement("div",{className:"Fdo Aic"},e.createElement("div",{className:"page _4EzTm ovd  Vgd"},e.createElement("div",{onClick:I,className:" LCR Fdo Lns Aic",style:{height:36,width:36}},e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},e.createElement("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),e.createElement("circle",{cx:"12",cy:"13",r:"4"}))))),e.createElement("input",{className:"mkhogb32",accept:X.fileaccepted,type:"file",multiple:!0,onChange:B,style:{display:"none"},ref:E})),e.createElement(J,{ModalConfident:z,Confidentiality:u,handleChangeConfidentiality:R,setModalConfident:N})),e.createElement("div",{className:"Fdo aovydwv3 pybr56ya"},p?p&&e.createElement("div",{className:"Fdo Lns Bsj"},e.createElement("span",{className:"sqdOP Xdg L3NKy ZIAjV Bsj _Dvgb"},"Publication du contenu...")):e.createElement(e.Fragment,null,a.length>0||v(d).length>0?e.createElement("button",{className:"sqdOP Xdg L3NKy ZIAjV Bsj _Dvgb",onClick:U},"Publier"):e.createElement("div",{className:"sqdOP Xdg L3NKy ZIAjV Bsj hdBtn"},"Publier"))))};export{le as default};
